<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Concilia√ß√£o Mercado Pago V3</title>
    <link rel="stylesheet" href="/static/css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <h1>üí∞ Sistema de Concilia√ß√£o Mercado Pago</h1>
        <p class="version">Vers√£o 3.0 - Sistema Completo</p>
        <div class="header-status">
          <span>Status: </span>
          <span id="system-status" class="badge badge-warning"
            >N√£o processado</span
          >
        </div>
      </header>

      <!-- Notifica√ß√£o -->
      <div id="notification" class="notification"></div>

      <!-- Controles Principais -->
      <div class="controls">
        <button id="btn-process" class="btn btn-primary">
          <i class="fas fa-sync"></i> Processar Dados
        </button>
        <button id="btn-clear" class="btn btn-danger">
          <i class="fas fa-trash"></i> Limpar Cache
        </button>
        <button id="btn-refresh" class="btn btn-success">
          <i class="fas fa-refresh"></i> Atualizar Status
        </button>
      </div>

      <!-- Tabs de Navega√ß√£o -->
      <div class="tabs">
        <button class="tab-button active" data-tab="dashboard">
          <i class="fas fa-chart-line"></i> Dashboard
        </button>
        <button class="tab-button" data-tab="cashflow">
          <i class="fas fa-calendar-alt"></i> Fluxo de Caixa
        </button>
        <button class="tab-button" data-tab="overdue">
          <i class="fas fa-exclamation-triangle"></i> Atrasados
        </button>
        <button class="tab-button" data-tab="pending">
          <i class="fas fa-hourglass-half"></i> Pendentes
        </button>
        <button class="tab-button" data-tab="received">
          <i class="fas fa-check-circle"></i> Recebidos
        </button>
        <button class="tab-button" data-tab="transactions">
          <i class="fas fa-list"></i> Transa√ß√µes
        </button>
        <button class="tab-button" data-tab="reconciliation">
          <i class="fas fa-search"></i> Concilia√ß√£o
        </button>
      </div>

      <!-- Conte√∫do das Tabs -->
      <div class="tab-contents">
        <!-- TAB: DASHBOARD -->
        <div id="tab-dashboard" class="tab-content active">
          <h2>Resumo Geral</h2>

          <div class="cards-grid">
            <!-- Card: Total Esperado -->
            <div class="card card-info">
              <div class="card-header">
                <h3>TOTAL ESPERADO</h3>
              </div>
              <div class="card-body">
                <p class="card-value" id="total-expected-value">R$ 0,00</p>
                <p class="card-subtitle" id="total-expected-count">
                  0 parcelas
                </p>
              </div>
            </div>

            <!-- Card: Total Recebido -->
            <div class="card card-success">
              <div class="card-header">
                <h3>TOTAL RECEBIDO</h3>
              </div>
              <div class="card-body">
                <p class="card-value" id="total-received-value">R$ 0,00</p>
                <p class="card-subtitle" id="total-received-count">
                  0 parcelas
                </p>
                <p class="card-percent" id="total-received-percent">
                  0% do esperado
                </p>
              </div>
            </div>

            <!-- Card: Pendente -->
            <div class="card card-warning">
              <div class="card-header">
                <h3>PENDENTE</h3>
              </div>
              <div class="card-body">
                <p class="card-value" id="total-pending-value">R$ 0,00</p>
                <p class="card-subtitle" id="total-pending-count">0 parcelas</p>
                <p class="card-percent" id="total-pending-percent">
                  0% do esperado
                </p>
              </div>
            </div>

            <!-- Card: Atrasado -->
            <div class="card card-danger">
              <div class="card-header">
                <h3>ATRASADO</h3>
              </div>
              <div class="card-body">
                <p class="card-value" id="total-overdue-value">R$ 0,00</p>
                <p class="card-subtitle" id="total-overdue-count">0 parcelas</p>
                <p class="card-percent" id="total-overdue-percent">
                  0% do esperado
                </p>
              </div>
            </div>
          </div>

          <!-- Informa√ß√µes do Sistema -->
          <div class="system-info-box">
            <h3>Informa√ß√µes do Sistema</h3>
            <div id="system-info" class="system-info">
              <p>Clique em "Processar Dados" para come√ßar</p>
            </div>
          </div>
        </div>

        <!-- TAB: FLUXO DE CAIXA -->
        <div id="tab-cashflow" class="tab-content">
          <div class="cashflow-header">
            <h2>Fluxo de Caixa</h2>
            <div class="cashflow-toggle">
              <button id="btn-monthly" class="toggle-btn active">
                <i class="fas fa-calendar"></i> Por M√™s
              </button>
              <button id="btn-daily" class="toggle-btn">
                <i class="fas fa-calendar-day"></i> Por Dia
              </button>
            </div>
          </div>
          <div id="cashflow-monthly-view" class="cashflow-view"></div>
          <div id="cashflow-daily-view" class="cashflow-view" style="display: none;"></div>
        </div>

        <!-- TAB: ATRASADOS -->
        <div id="tab-overdue" class="tab-content">
          <h2>Parcelas Atrasadas</h2>
          <div id="overdue-table"></div>
        </div>

        <!-- TAB: PENDENTES -->
        <div id="tab-pending" class="tab-content">
          <h2>Parcelas Pendentes</h2>
          <div id="pending-table"></div>
        </div>

        <!-- TAB: RECEBIDOS -->
        <div id="tab-received" class="tab-content">
          <h2>Parcelas Recebidas</h2>

          <!-- Filtros -->
          <div class="filters-container">
            <div class="filter-group">
              <label for="filter-received-type">Tipo:</label>
              <select id="filter-received-type" class="filter-select">
                <option value="all">Todos</option>
                <option value="received">Normal</option>
                <option value="received_advance">Antecipado</option>
              </select>
            </div>

            <div class="filter-group">
              <label for="filter-received-date-start">Data inicial:</label>
              <input type="date" id="filter-received-date-start" class="filter-input">
            </div>

            <div class="filter-group">
              <label for="filter-received-date-end">Data final:</label>
              <input type="date" id="filter-received-date-end" class="filter-input">
            </div>

            <div class="filter-group">
              <label for="filter-received-min-value">Valor m√≠nimo:</label>
              <input type="number" id="filter-received-min-value" class="filter-input" placeholder="0.00" step="0.01">
            </div>

            <div class="filter-group">
              <label for="filter-received-max-value">Valor m√°ximo:</label>
              <input type="number" id="filter-received-max-value" class="filter-input" placeholder="0.00" step="0.01">
            </div>

            <button id="btn-apply-received-filter" class="btn btn-primary btn-sm">
              <i class="fas fa-filter"></i> Aplicar Filtros
            </button>

            <button id="btn-clear-received-filter" class="btn btn-secondary btn-sm">
              <i class="fas fa-times"></i> Limpar
            </button>
          </div>

          <div id="received-table"></div>
        </div>

        <!-- TAB: TRANSA√á√ïES -->
        <div id="tab-transactions" class="tab-content">
          <h2>Transa√ß√µes</h2>

          <!-- Filtros -->
          <div class="filters-container">
            <div class="filter-group">
              <label for="filter-transaction-type">Tipo:</label>
              <select id="filter-transaction-type" class="filter-select">
                <option value="all">Todos</option>
              </select>
            </div>

            <div class="filter-group">
              <label for="filter-transaction-method">M√©todo:</label>
              <select id="filter-transaction-method" class="filter-select">
                <option value="all">Todos</option>
              </select>
            </div>

            <div class="filter-group">
              <label for="filter-transaction-date-start">Data inicial:</label>
              <input type="date" id="filter-transaction-date-start" class="filter-input">
            </div>

            <div class="filter-group">
              <label for="filter-transaction-date-end">Data final:</label>
              <input type="date" id="filter-transaction-date-end" class="filter-input">
            </div>

            <div class="filter-group">
              <label for="filter-transaction-min-value">Valor m√≠nimo:</label>
              <input type="number" id="filter-transaction-min-value" class="filter-input" placeholder="0.00" step="0.01">
            </div>

            <div class="filter-group">
              <label for="filter-transaction-max-value">Valor m√°ximo:</label>
              <input type="number" id="filter-transaction-max-value" class="filter-input" placeholder="0.00" step="0.01">
            </div>

            <button id="btn-apply-transaction-filter" class="btn btn-primary btn-sm">
              <i class="fas fa-filter"></i> Aplicar Filtros
            </button>

            <button id="btn-clear-transaction-filter" class="btn btn-secondary btn-sm">
              <i class="fas fa-times"></i> Limpar
            </button>
          </div>

          <div id="transactions-table"></div>
        </div>

        <!-- TAB: CONCILIA√á√ÉO -->
        <div id="tab-reconciliation" class="tab-content">
          <h2>Relat√≥rio de Concilia√ß√£o</h2>

          <!-- Debug de External Reference -->
          <div class="debug-container">
            <h4>üîç An√°lise de External Reference</h4>
            <div class="debug-input-group">
              <input
                type="text"
                id="debug-external-ref"
                class="filter-input"
                placeholder="Cole a external reference aqui (ex: r7eA2T63QGdKMwLY8zwox1cJU)"
                style="flex: 1; min-width: 300px;">
              <button id="btn-debug-reference" class="btn btn-primary btn-sm">
                <i class="fas fa-search"></i> Analisar
              </button>
            </div>
            <div id="debug-results" style="margin-top: 15px;"></div>
          </div>

          <div id="reconciliation-report"></div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="/static/js/app.js"></script>
  </body>
</html>
